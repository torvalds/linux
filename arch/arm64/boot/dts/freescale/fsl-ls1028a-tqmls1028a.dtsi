// SPDX-License-Identifier: (GPL-2.0-or-later OR MIT)
/*
 * Copyright 2019-2025 TQ-Systems GmbH <linux@ew.tq-group.com>,
 * D-82229 Seefeld, Germany.
 * Author: Michael Krummsdorf
 * Author: Matthias Schiffer
 * Author: Alexander Stein
 */

#include "fsl-ls1028a.dtsi"

/ {
	compatible = "tq,ls1028a-tqmls1028a", "fsl,ls1028a";

	reg_1p8v_som: regulator-1p8v-som {
		compatible = "regulator-fixed";
		regulator-name = "1P8V_SOM";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
		regulator-always-on;
	};

	reg_3p3v_som: regulator-3p3v-som {
		compatible = "regulator-fixed";
		regulator-name = "3P3V_SOM";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
		regulator-always-on;
	};

	thermal-zones {
		/*
		 * TQMLS1028A uses an external temperature sensor
		 * instead of TMU
		 */
		/delete-node/ ddr-controller;

		cluster-thermal {
			thermal-sensors = <&sa56004_4c 1>;
		};
	};
};

&esdhc1 {
	no-sdio;
	no-sd;
	non-removable;
	mmc-hs200-1_8v;
	mmc-hs400-1_8v;
	mmc-ddr-1_8v;
	bus-width = <8>;
	vmmc-supply = <&reg_3p3v_som>;
	vqmmc-supply = <&reg_1p8v_som>;
	status = "okay";
};

&fspi {
	status = "okay";

	flash@0 {
		compatible = "jedec,spi-nor";
		reg = <0>;
		spi-max-frequency = <100000000>;
		spi-tx-bus-width = <4>;
		spi-rx-bus-width = <4>;
		vcc-supply = <&reg_1p8v_som>;

		partitions {
			compatible = "fixed-partitions";
			#address-cells = <1>;
			#size-cells = <1>;
		};
	};
};

&i2c0 {
	clock-frequency = <400000>;
	status = "okay";

	js42_18: temperature-sensor@18 {
		compatible = "nxp,se97b", "jedec,jc-42.4-temp";
		reg = <0x18>;
	};

	sa56004_4c: temperature-sensor@4c {
		compatible = "nxp,sa56004";
		reg = <0x4c>;
		#thermal-sensor-cells = <1>;
		vcc-supply = <&reg_3p3v_som>;
	};

	se97_50: eeprom@50 {
		compatible = "nxp,se97b", "atmel,24c02";
		read-only;
		reg = <0x50>;
		pagesize = <16>;
		vcc-supply = <&reg_3p3v_som>;
	};

	rtc1: rtc@51 {
		compatible = "nxp,pcf85063a";
		reg = <0x51>;
		quartz-load-femtofarads = <12500>;
	};

	m24c256_57: eeprom@57 {
		compatible = "atmel,24c256";
		reg = <0x57>;
		pagesize = <32>;
		vcc-supply = <&reg_3p3v_som>;
	};
};

/*
 * We use a separate sensor IC to measure core temperature. Disable the TMU
 * as its driver can cause log spam outside of its measurement range (0-125C).
 *
 * Will have to be reevaluated if this DTS is ported to a mainline kernel,
 * as both sensors of the TMU are referenced by the default LS1028A
 * thermal-zones definitions there.
 */
&tmu {
	status = "disabled";
};
