[
    {
        "id": "901f",
        "name": "Add fw filter with prio at 32-bit maxixum",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 65535 fw action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 65535 protocol all fw",
        "matchPattern": "pref 65535 fw.*handle 0x1.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "51e2",
        "name": "Add fw filter with prio exceeding 32-bit maxixum",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 65536 fw action ok",
        "expExitCode": "255",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 65536 protocol all fw",
        "matchPattern": "pref 65536 fw.*handle 0x1.*gact action pass",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "d987",
        "name": "Add fw filter with action ok",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "c591",
        "name": "Add fw filter with action ok by reference",
        "__comment": "We add sleep here because action might have not been deleted by workqueue just yet. Remove this when the behaviour is fixed.",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "/bin/sleep 1",
            "$TC actions add action gact ok index 1"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action gact index 1",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action pass.*index 1 ref 2 bind 1",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress",
            "/bin/sleep 1",
            "$TC actions del action gact index 1"
        ]
    },
    {
        "id": "affe",
        "name": "Add fw filter with action continue",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action continue",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action continue",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "38b3",
        "name": "Add fw filter with action continue by reference",
        "__comment": "We add sleep here because action might have not been deleted by workqueue just yet. Remove this when the behaviour is fixed.",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "/bin/sleep 1",
            "$TC actions add action gact continue index 1"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action gact index 1",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action continue.*index 1 ref 2 bind 1",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress",
            "/bin/sleep 1",
            "$TC actions del action gact index 1"
        ]
    },
    {
        "id": "28bc",
        "name": "Add fw filter with action pipe",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action pipe",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action pipe",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "6753",
        "name": "Add fw filter with action pipe by reference",
        "__comment": "We add sleep here because action might have not been deleted by workqueue just yet.",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "/bin/sleep 1",
            "$TC actions add action gact pipe index 1"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action gact index 1",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action pipe.*index 1 ref 2 bind 1",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress",
            "/bin/sleep 1",
            "$TC actions del action gact index 1"
        ]
    },
    {
        "id": "8da2",
        "name": "Add fw filter with action drop",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action drop",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 protocol all prio 1 fw",
        "matchPattern": "handle 0x1.*gact action drop",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "6dc6",
        "name": "Add fw filter with action drop by reference",
        "__comment": "We add sleep here because action might have not been deleted by workqueue just yet.",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "/bin/sleep 1",
            "$TC actions add action gact drop index 1"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action gact index 1",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action drop.*index 1 ref 2 bind 1",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress",
            "/bin/sleep 1",
            "$TC actions del action gact index 1"
        ]
    },
    {
        "id": "9436",
        "name": "Add fw filter with action reclassify",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action reclassify",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action reclassify",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "3bc2",
        "name": "Add fw filter with action reclassify by reference",
        "__comment": "We add sleep here because action might have not been deleted by workqueue just yet.",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "/bin/sleep 1",
            "$TC actions add action gact reclassify index 1"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action gact index 1",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action reclassify.*index 1 ref 2 bind 1",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress",
            "/bin/sleep 1",
            "$TC actions del action gact index 1"
        ]
    },
    {
        "id": "95bb",
        "name": "Add fw filter with action jump 10",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action jump 10",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action jump 10",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "36f7",
        "name": "Add fw filter with action jump 10 by reference",
        "__comment": "We add sleep here because action might have not been deleted by workqueue just yet.",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "/bin/sleep 1",
            "$TC actions add action gact jump 10 index 1"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action gact index 1",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action jump 10.*index 1 ref 2 bind 1",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress",
            "/bin/sleep 1",
            "$TC actions del action gact index 1"
        ]
    },
    {
        "id": "3d74",
        "name": "Add fw filter with action goto chain 5",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action goto chain 5",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action goto chain 5",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "eb8f",
        "name": "Add fw filter with invalid action",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw action pump",
        "expExitCode": "255",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "handle 0x1.*gact action pump",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "6a79",
        "name": "Add fw filter with missing mandatory action",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw",
        "expExitCode": "2",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "filter protocol all pref [0-9]+ fw.*handle 0x1",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "8298",
        "name": "Add fw filter with cookie",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 2 fw action pipe cookie aa11bb22cc33dd44ee55ff66aa11b1b2",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 2 protocol all fw",
        "matchPattern": "pref 2 fw.*handle 0x1.*gact action pipe.*cookie aa11bb22cc33dd44ee55ff66aa11b1b2",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "a88c",
        "name": "Add fw filter with invalid cookie",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 2 fw action continue cookie aa11bb22cc33dd44ee55ff66aa11b1b2777888",
        "expExitCode": "255",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 2 protocol all fw",
        "matchPattern": "pref 2 fw.*handle 0x1.*gact action continue.*cookie aa11bb22cc33dd44ee55ff66aa11b1b2777888",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "10f6",
        "name": "Add fw filter with handle in hex",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 0xa1b2ff prio 1 fw action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 0xa1b2ff prio 1 protocol all fw",
        "matchPattern": "fw.*handle 0xa1b2ff.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "9d51",
        "name": "Add fw filter with handle at 32-bit maximum",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 4294967295 prio 1 fw action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 4294967295 prio 1 protocol all fw",
        "matchPattern": "fw.*handle 0xffffffff.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "d939",
        "name": "Add fw filter with handle exceeding 32-bit maximum",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 4294967296 prio 1 fw action ok",
        "expExitCode": "1",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 4294967296 prio 1 protocol all fw",
        "matchPattern": "fw.*handle 0x.*gact action pass",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "658c",
        "name": "Add fw filter with mask in hex",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 10/0xa1b2f prio 1 fw action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 10 prio 1 protocol all fw",
        "matchPattern": "fw.*handle 0xa/0xa1b2f",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "86be",
        "name": "Add fw filter with mask at 32-bit maximum",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 10/4294967295 prio 1 fw action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 10 prio 1 protocol all fw",
        "matchPattern": "fw.*handle 0xa[^/]",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "e635",
        "name": "Add fw filter with mask exceeding 32-bit maximum",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 10/4294967296 prio 1 fw action ok",
        "expExitCode": "1",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 10 prio 1 protocol all fw",
        "matchPattern": "fw.*handle 0xa",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "6cab",
        "name": "Add fw filter with handle/mask in hex",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 0xa1b2cdff/0x1a2bffdc prio 1 fw action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 0xa1b2cdff prio 1 protocol all fw",
        "matchPattern": "fw.*handle 0xa1b2cdff/0x1a2bffdc",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "8700",
        "name": "Add fw filter with handle/mask at 32-bit maximum",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 4294967295/4294967295 prio 1 fw action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 0xffffffff prio 1 protocol all fw",
        "matchPattern": "fw.*handle 0xffffffff[^/]",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "7d62",
        "name": "Add fw filter with handle/mask exceeding 32-bit maximum",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 4294967296/4294967296 prio 1 fw action ok",
        "expExitCode": "1",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 10 prio 1 protocol all fw",
        "matchPattern": "fw.*handle",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "7b69",
        "name": "Add fw filter with missing mandatory handle",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: prio 1 fw action ok",
        "expExitCode": "2",
        "verifyCmd": "$TC filter show dev $DEV1 parent ffff:",
        "matchPattern": "filter protocol all.*fw.*handle.*gact action pass",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "d68b",
        "name": "Add fw filter with invalid parent",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent aa11b1b2: handle 1 prio 1 fw action ok",
        "expExitCode": "255",
        "verifyCmd": "$TC filter dev $DEV1 parent aa11b1b2: handle 1 prio 1 protocol all fw",
        "matchPattern": "filter protocol all pref 1 fw.*handle 0x1.*gact action pass",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "66e0",
        "name": "Add fw filter with missing mandatory parent id",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 handle 1 prio 1 fw action ok",
        "expExitCode": "2",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "pref [0-9]+ fw.*handle 0x1.*gact action pass",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "0ff3",
        "name": "Add fw filter with classid",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw classid 3 action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "fw.*handle 0x1 classid :3.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "9849",
        "name": "Add fw filter with classid at root",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw classid ffff:ffff action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "pref 1 fw.*handle 0x1 classid root.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "b7ff",
        "name": "Add fw filter with classid - keeps last 8 (hex) digits",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw classid 98765fedcb action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "fw.*handle 0x1 classid 765f:edcb.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "2b18",
        "name": "Add fw filter with invalid classid",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 1 prio 1 fw classid 6789defg action ok",
        "expExitCode": "1",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol all fw",
        "matchPattern": "fw.*handle 0x1 classid 6789:defg.*gact action pass",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "fade",
        "name": "Add fw filter with flowid",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 10 prio 1 fw flowid 1:10 action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 10 prio 1 protocol all fw",
        "matchPattern": "filter parent ffff: protocol all pref 1 fw.*handle 0xa classid 1:10.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "33af",
        "name": "Add fw filter with flowid then classid (same arg, takes second)",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 11 prio 1 fw flowid 10 classid 4 action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 11 prio 1 protocol all fw",
        "matchPattern": "filter parent ffff: protocol all pref 1 fw.*handle 0xb classid :4.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "8a8c",
        "name": "Add fw filter with classid then flowid (same arg, takes second)",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: handle 11 prio 1 fw classid 4 flowid 10 action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 11 prio 1 protocol all fw",
        "matchPattern": "filter parent ffff: protocol all pref 1 fw.*handle 0xb classid :10.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "b50d",
        "name": "Add fw filter with handle val/mask and flowid 10:1000",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: prio 3 handle 10/0xff fw flowid 10:1000 action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 10 prio 3 protocol all fw",
        "matchPattern": "filter parent ffff: protocol all pref 3 fw.*handle 0xa/0xff classid 10:1000.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "7207",
        "name": "Add fw filter with protocol ip",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: protocol ip prio 1 handle 3 fw action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 3 prio 1 protocol ip fw",
        "matchPattern": "filter parent ffff: protocol ip pref 1 fw.*handle 0x3.*gact action pass.*index [0-9]+ ref [0-9]+ bind [0-9]+",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "306d",
        "name": "Add fw filter with protocol ipv6",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: protocol ipv6 prio 2 handle 4 fw action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 4 prio 2 protocol ipv6 fw",
        "matchPattern": "filter parent ffff: protocol ipv6 pref 2 fw.*handle 0x4.*gact action pass.*index [0-9]+ ref [0-9]+ bind [0-9]+",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "9a78",
        "name": "Add fw filter with protocol arp",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: protocol arp prio 5 handle 7 fw action drop",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 7 prio 5 protocol arp fw",
        "matchPattern": "filter parent ffff: protocol arp pref 5 fw.*handle 0x7.*gact action drop.*index [0-9]+ ref [0-9]+ bind [0-9]+",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "1821",
        "name": "Add fw filter with protocol 802_3",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: protocol 802_3 handle 1 prio 1 fw action ok",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol 802_3 fw",
        "matchPattern": "filter parent ffff: protocol 802_3 pref 1 fw.*handle 0x1.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "2260",
        "name": "Add fw filter with invalid protocol",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: protocol igmp handle 1 prio 1 fw action ok",
        "expExitCode": "255",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 1 prio 1 protocol igmp fw",
        "matchPattern": "filter parent ffff: protocol igmp pref 1 fw.*handle 0x1.*gact action pass",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "09d7",
        "name": "Add fw filters protocol 802_3 and ip with conflicting priorities",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: protocol 802_3 prio 3 handle 7 fw action ok"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: protocol ip prio 3 handle 8 fw action ok",
        "expExitCode": "2",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 8 prio 3 protocol ip fw",
        "matchPattern": "filter parent ffff: protocol ip pref 3 fw.*handle 0x8",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "6973",
        "name": "Add fw filters with same index, same action",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: prio 6 handle 2 fw action continue index 5"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: prio 8 handle 4 fw action continue index 5",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 4 prio 8 protocol all fw",
        "matchPattern": "filter parent ffff: protocol all pref 8 fw.*handle 0x4.*gact action continue.*index 5 ref 2 bind 2",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "fc06",
        "name": "Add fw filters with action police",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: prio 3 handle 4 fw action police rate 1kbit burst 10k index 5",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 4 prio 3 protocol all fw",
        "matchPattern": "filter parent ffff: protocol all pref 3 fw.*handle 0x4.*police 0x5 rate 1Kbit burst 10Kb mtu 2Kb action reclassify overhead 0b.*ref 1 bind 1",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "aac7",
        "name": "Add fw filters with action police linklayer atm",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress"
        ],
        "cmdUnderTest": "$TC filter add dev $DEV1 parent ffff: prio 3 handle 4 fw action police rate 2mbit burst 200k linklayer atm index 8",
        "expExitCode": "0",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 4 prio 3 protocol all fw",
        "matchPattern": "filter parent ffff: protocol all pref 3 fw.*handle 0x4.*police 0x8 rate 2Mbit burst 200Kb mtu 2Kb action reclassify overhead 0b linklayer atm.*ref 1 bind 1",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "5339",
        "name": "Del entire fw filter",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: handle 5 prio 7 fw action pass",
            "$TC filter add dev $DEV1 parent ffff: handle 3 prio 9 fw action pass"
        ],
        "cmdUnderTest": "$TC filter del dev $DEV1 parent ffff:",
        "expExitCode": "0",
        "verifyCmd": "$TC filter show dev $DEV1 parent ffff:",
        "matchPattern": "protocol all pref.*handle.*gact action pass",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "0e99",
        "name": "Del single fw filter x1",
        "__comment__": "First of two tests to check that one filter is there and the other isn't",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: handle 5 prio 7 fw action pass",
            "$TC filter add dev $DEV1 parent ffff: handle 3 prio 9 fw action pass"
        ],
        "cmdUnderTest": "$TC filter del dev $DEV1 parent ffff: handle 3 prio 9 fw action pass",
        "expExitCode": "0",
        "verifyCmd": "$TC filter show dev $DEV1 parent ffff:",
        "matchPattern": "protocol all pref 7.*handle 0x5.*gact action pass",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "f54c",
        "name": "Del single fw filter x2",
        "__comment__": "Second of two tests to check that one filter is there and the other isn't",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: handle 5 prio 7 fw action pass",
            "$TC filter add dev $DEV1 parent ffff: handle 3 prio 9 fw action pass"
        ],
        "cmdUnderTest": "$TC filter del dev $DEV1 parent ffff: handle 3 prio 9 fw action pass",
        "expExitCode": "0",
        "verifyCmd": "$TC filter show dev $DEV1 parent ffff:",
        "matchPattern": "protocol all pref 9.*handle 0x3.*gact action pass",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "ba94",
        "name": "Del fw filter by prio",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: handle 1 prio 4 fw action ok",
            "$TC filter add dev $DEV1 parent ffff: handle 2 prio 4 fw action ok"
        ],
        "cmdUnderTest": "$TC filter del dev $DEV1 parent ffff: prio 4",
        "expExitCode": "0",
        "verifyCmd": "$TC filter show dev $DEV1 parent ffff:",
        "matchPattern": "pref 4 fw.*gact action pass",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "4acb",
        "name": "Del fw filter by chain",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: handle 4 prio 2 chain 13 fw action pipe",
            "$TC filter add dev $DEV1 parent ffff: handle 3 prio 5 chain 13 fw action pipe"
        ],
        "cmdUnderTest": "$TC filter del dev $DEV1 parent ffff: chain 13",
        "expExitCode": "0",
        "verifyCmd": "$TC filter show dev $DEV1 parent ffff:",
        "matchPattern": "fw chain 13 handle.*gact action pipe",
        "matchCount": "0",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "3424",
        "name": "Del fw filter by action (invalid)",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: handle 2 prio 4 fw action drop"
        ],
        "cmdUnderTest": "$TC filter del dev $DEV1 parent ffff: fw action drop",
        "expExitCode": "2",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 2 prio 4 protocol all fw",
        "matchPattern": "handle 0x2.*gact action drop",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "da89",
        "name": "Del fw filter by handle (invalid)",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: handle 3 prio 4 fw action continue"
        ],
        "cmdUnderTest": "$TC filter del dev $DEV1 parent ffff: handle 3 fw",
        "expExitCode": "2",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 3 prio 4 protocol all fw",
        "matchPattern": "handle 0x3.*gact action continue",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "4d95",
        "name": "Del fw filter by protocol (invalid)",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: handle 4 prio 2 protocol arp fw action pipe"
        ],
        "cmdUnderTest": "$TC filter del dev $DEV1 parent ffff: protocol arp fw",
        "expExitCode": "2",
        "verifyCmd": "$TC filter get dev $DEV1 parent ffff: handle 4 prio 2 protocol arp fw",
        "matchPattern": "filter parent ffff: protocol arp.*handle 0x4.*gact action pipe",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "4736",
        "name": "Del fw filter by flowid (invalid)",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: handle 4 prio 2 fw action pipe flowid 45"
        ],
        "cmdUnderTest": "$TC filter del dev $DEV1 parent ffff: fw flowid 45",
        "expExitCode": "2",
        "verifyCmd": "$TC filter show dev $DEV1 parent ffff:",
        "matchPattern": "handle 0x4.*gact action pipe",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "3dcb",
        "name": "Replace fw filter action",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: handle 1 prio 2 fw action ok"
        ],
        "cmdUnderTest": "$TC filter replace dev $DEV1 parent ffff: handle 1 prio 2 fw action pipe",
        "expExitCode": "0",
        "verifyCmd": "$TC filter show dev $DEV1 parent ffff:",
        "matchPattern": "pref 2 fw.*handle 0x1.*gact action pipe",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "eb4d",
        "name": "Replace fw filter classid",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: handle 1 prio 2 fw action ok"
        ],
        "cmdUnderTest": "$TC filter replace dev $DEV1 parent ffff: handle 1 prio 2 fw action pipe classid 2",
        "expExitCode": "0",
        "verifyCmd": "$TC filter show dev $DEV1 parent ffff:",
        "matchPattern": "pref 2 fw.*handle 0x1 classid :2.*gact action pipe",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    },
    {
        "id": "67ec",
        "name": "Replace fw filter index",
        "category": [
            "filter",
            "fw"
        ],
        "setup": [
            "$TC qdisc add dev $DEV1 ingress",
            "$TC filter add dev $DEV1 parent ffff: handle 1 prio 2 fw action ok index 3"
        ],
        "cmdUnderTest": "$TC filter replace dev $DEV1 parent ffff: handle 1 prio 2 fw action ok index 16",
        "expExitCode": "0",
        "verifyCmd": "$TC filter show dev $DEV1 parent ffff:",
        "matchPattern": "pref 2 fw.*handle 0x1.*gact action pass.*index 16",
        "matchCount": "1",
        "teardown": [
            "$TC qdisc del dev $DEV1 ingress"
        ]
    }
]
