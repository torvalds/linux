# SPDX-License-Identifier: MIT
# Copyright Â© 2019 Intel Corporation

# Test the headers are compilable as standalone units
header_test := \
	i915_active_types.h \
	i915_debugfs.h \
	i915_drv.h \
	i915_fixed.h \
	i915_gem_gtt.h \
	i915_globals.h \
	i915_irq.h \
	i915_params.h \
	i915_priolist_types.h \
	i915_pvinfo.h \
	i915_reg.h \
	i915_scheduler_types.h \
	i915_utils.h \
	i915_vgpu.h \
	intel_csr.h \
	intel_drv.h \
	intel_pm.h \
	intel_runtime_pm.h \
	intel_sideband.h \
	intel_uncore.h \
	intel_wakeref.h

quiet_cmd_header_test = HDRTEST $@
      cmd_header_test = echo "\#include \"$(<F)\"" > $@

header_test_%.c: %.h
	$(call cmd,header_test)

i915-$(CONFIG_DRM_I915_WERROR) += $(foreach h,$(header_test),$(patsubst %.h,header_test_%.o,$(h)))

clean-files += $(foreach h,$(header_test),$(patsubst %.h,header_test_%.c,$(h)))
